From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Basil Chew <basil.chew@intel.com>
Date: Thu, 15 Sep 2022 12:51:08 +0800
Subject: [PATCH] Update host setup to QEMU 7.1

Change:
- updated setup_host.sh to install QEMU 7.1
- ensured submodules are updated before patching

Change-Id: I0ec881407b9f8ff1ea99858c8887caacf057db94
---
 scripts/setup_host.sh | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/scripts/setup_host.sh b/scripts/setup_host.sh
index 3ba55e8..26a923a 100755
--- a/scripts/setup_host.sh
+++ b/scripts/setup_host.sh
@@ -9,7 +9,7 @@ set -eE
 
 #---------      Global variable     -------------------
 reboot_required=0
-QEMU_REL="qemu-7.0.0"
+QEMU_REL="qemu-7.1.0"
 CIV_WORK_DIR=$(pwd)
 CIV_GOP_DIR=$CIV_WORK_DIR/GOP_PKG
 CIV_VERTICAl_DIR=$CIV_WORK_DIR/vertical_patches/host
@@ -95,6 +95,7 @@ function ubu_build_ovmf_gvt(){
     git clone https://github.com/tianocore/edk2.git
     cd $CIV_WORK_DIR/edk2
     git checkout -b stable202111 edk2-stable202111
+    git submodule update --init
 
     patch -p1 < $CIV_WORK_DIR/patches/ovmf/0001-OvmfPkg-add-IgdAssignmentDxe.patch
     if [ -d $CIV_GOP_DIR ]; then
@@ -110,8 +111,6 @@ function ubu_build_ovmf_gvt(){
         done
     fi
 
-    git submodule update --init
-
     source ./edksetup.sh
     make -C BaseTools/
     build -b DEBUG -t GCC5 -a X64 -p OvmfPkg/OvmfPkgX64.dsc -D NETWORK_IP4_ENABLE -D NETWORK_ENABLE  -D SECURE_BOOT_ENABLE -D TPM_ENABLE
-- 
2.17.1

